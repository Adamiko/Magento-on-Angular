/*! Mao by Adam Timberlake created on 2013-09-03 */
!function(a){"use strict";a.mao=angular.module("maoApp",[]).config(["$routeProvider","$provide","$locationProvider",function(a,b,c){a.when("/",{templateUrl:"views/home.html"}).when("/category/:category",{templateUrl:"views/category.html"}).when("/category/:category/:subCategory",{templateUrl:"views/category.html"}).when("/products",{templateUrl:"views/products.html"}).otherwise({redirectTo:"/error/not-found"}),c.html5Mode(!1).hashPrefix("!")}])}(window),function(a,b){"use strict";a.factory("$categoryHelper",["$rootScope",function(a){var c={},d=b.Deferred();return c.hasLoaded=function(){return d.promise()},c.find=function(a,b){var d=c.categories.filter(function(b){return b.ident===a})[0];if(b)var e=d.children.filter(function(a){return a.ident===b})[0];return{category:d,subCategory:e}},a.$on("loadedCategories",function(a,b){c.categories=b,d.resolve()}),c}])}(window.mao,window.jQuery),function(a){"use strict";a.factory("$crossfilterHelper",["$rootScope",function(){var a={};return a.crossfilter={},a.dimensions=[],a.create=function(b){return a.crossfilter=crossfilter(b)},a.addDimension=function(b){return a.dimensions[b]=a.crossfilter.dimension(function(a){return a[b]})},a.get=function(b){return a.dimensions[b]},a}])}(window.mao,window.jQuery,window.crossfilter),function(a,b){"use strict";a.factory("$productHelper",["$rootScope","$http","$crossfilterHelper",function(a,c,d){var e={},f=c({method:"GET",url:"/Magento-on-Angular/api/public/products"});f.success(function(b){d.create(b),d.addDimension("id"),d.addDimension("categories"),a.$broadcast("loadedProducts")});var g=b.Deferred();return e.hasLoaded=function(){return g.promise()},a.$on("loadedProducts",function(a,b){e.products=b,g.resolve()}),e}])}(window.mao,window.jQuery),function(a){"use strict";a.controller("CategoriesController",["$scope","$http",function(a,b){a.categories=[];var c=b({method:"GET",url:"/Magento-on-Angular/api/public/categories"});c.success(function(b){a.categories=b,a.$emit("loadedCategories",b)})}])}(window.mao),function(a){"use strict";a.controller("CategoryController",["$rootScope","$scope","$routeParams","$categoryHelper",function(a,b,c,d){d.hasLoaded().then(function(){var a=c.subCategory||null,e=d.find(c.category,a);b.category=e.category,b.subCategory=e.subCategory;var f=b.subCategory?b.subCategory.id:b.category.id;b.$watch("$viewContentLoaded",function(){b.$broadcast("switchedCategory",f)})})}])}(window.mao),function(a){"use strict";a.controller("HomeController",function(){})}(window.mao),function(a,b){"use strict";a.controller("ProductsController",["$rootScope","$scope","$http","$crossfilterHelper","$productHelper",function(a,c,d,e,f){c.products=[],c.hasLoaded=!1,c.$on("switchedCategory",function(a,d){f.hasLoaded().then(function(){var a=e.get("categories");a.filterAll(),a.filterFunction(function(a){return-1!==b.inArray(d,a)}),c.products=a.top(1/0),c.hasLoaded=!0})})}])}(window.mao,window.jQuery);